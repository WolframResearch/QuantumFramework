(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11984,        275]
NotebookOptionsPosition[     10991,        251]
NotebookOutlinePosition[     11388,        267]
CellTagsIndexPosition[     11345,        264]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalOmega]", " ", "=", " ", 
   RowBox[{"StadiumShape", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "0"}], "}"}]}], "}"}], ",", "10"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"LightBlue", ",", "\[CapitalOmega]"}], "}"}], ",", 
   RowBox[{"Axes", "->", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.938218670001629*^9, 3.938218690415653*^9}, {
  3.93821985246797*^9, 3.938219860303993*^9}, {3.938220703302237*^9, 
  3.938220710613366*^9}, {3.938261674213333*^9, 3.938261677306705*^9}, {
  3.938261713961533*^9, 3.938261717517626*^9}, {3.938267951510558*^9, 
  3.938267955239155*^9}},
 CellLabel->"In[180]:=",
 CellID->31662885,ExpressionUUID->"cd8ee6f3-8928-4503-8aab-84636ff8fb13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"initial", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]", "=", "1"}], ",", 
       RowBox[{"k", "=", "10"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"x", "^", "2"}], 
          RowBox[{"4", 
           RowBox[{"\[Sigma]", "^", "2"}]}]]}], "-", 
        FractionBox[
         RowBox[{"y", "^", "2"}], 
         RowBox[{"4", 
          RowBox[{
           RowBox[{"(", "\[Sigma]", ")"}], "^", "2"}]}]]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        RowBox[{"(", "x", ")"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ContourPlot", "[", 
  RowBox[{
   RowBox[{"Re", "[", "initial", "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "\[CapitalOmega]"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
   RowBox[{"Contours", "->", "4"}], ",", 
   RowBox[{"PlotPoints", "->", "100"}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.938220731176559*^9, 3.93822080317607*^9}, {
   3.938220833746159*^9, 3.938220853788684*^9}, {3.93822091574157*^9, 
   3.9382209194585533`*^9}, {3.938220959647895*^9, 3.9382209844740467`*^9}, {
   3.938221037719459*^9, 3.938221037881461*^9}, {3.938221589123712*^9, 
   3.9382216030581207`*^9}, {3.938221837323941*^9, 3.938221843499632*^9}, {
   3.93822188089821*^9, 3.9382218811252403`*^9}, {3.9382219706631107`*^9, 
   3.938221970876752*^9}, 3.9382220249727182`*^9, 3.938222064741835*^9, {
   3.938222715431073*^9, 3.9382227208417253`*^9}, {3.938223641835013*^9, 
   3.938223642321817*^9}, 3.938224088707055*^9, 3.9382241428299932`*^9, {
   3.938225490616392*^9, 3.938225500001133*^9}, {3.938226185264596*^9, 
   3.9382261968228693`*^9}, {3.9382262374068336`*^9, 3.9382262376604*^9}, {
   3.9382532948862047`*^9, 3.938253338355977*^9}, {3.93825343593342*^9, 
   3.938253459739368*^9}, {3.9382564106368628`*^9, 3.93825646057403*^9}, {
   3.938259043839541*^9, 3.938259049557102*^9}, {3.938259735339362*^9, 
   3.93825977419591*^9}, {3.9382602522281847`*^9, 3.938260267941914*^9}, {
   3.9382615057246027`*^9, 3.938261902480969*^9}, {3.938263093233251*^9, 
   3.9382631808719387`*^9}, {3.938265713093788*^9, 3.938265759551073*^9}, {
   3.938265843100541*^9, 3.938265847870427*^9}, {3.938266159299355*^9, 
   3.938266194900432*^9}, {3.9382662270803556`*^9, 3.938266448350165*^9}, {
   3.9382666171979723`*^9, 3.938266619882463*^9}, {3.938267957869527*^9, 
   3.938267962014586*^9}, {3.9382680468905773`*^9, 3.9382681073033648`*^9}, {
   3.938268156625374*^9, 3.9382681567803164`*^9}, {3.938268260740028*^9, 
   3.938268285385867*^9}, 3.9382683318138657`*^9, 3.938268418551124*^9, {
   3.938268540785303*^9, 3.938268541901453*^9}, {3.938268630324855*^9, 
   3.938268630583255*^9}, {3.938271848004682*^9, 3.9382718750768948`*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"5e5d45b9-9dc3-49ea-8eaf-8bb9892c3350"],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalH]", "=", 
  RowBox[{"SchrodingerPDEComponent", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalPsi]", "[", 
       RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", "t", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "}"}], ",", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<ReducedPlanckConstant\>\"", "->", "1"}], ",", 
      RowBox[{"\"\<Mass\>\"", "->", 
       RowBox[{"1", "/", "2"}]}]}], "|>"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.938217465504941*^9, 3.938217471220519*^9}, 
   3.938219608011178*^9, 3.9382241211489563`*^9, {3.938262350172805*^9, 
   3.9382623503012238`*^9}},
 CellLabel->"In[288]:=",
 CellID->647548651,ExpressionUUID->"395932fe-8368-4a05-9c30-3253299928e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bc", "=", 
   RowBox[{"DirichletCondition", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPsi]", "[", 
       RowBox[{"t", ",", "x", ",", "y"}], "]"}], "==", "0"}], ",", "True"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9382174833931*^9, 3.938217483598873*^9}, {
  3.938219494965373*^9, 3.938219561490958*^9}, {3.938219621247117*^9, 
  3.938219647768573*^9}, {3.938219928757308*^9, 3.938219934246744*^9}, {
  3.938220035416363*^9, 3.938220047307379*^9}, {3.938220122751234*^9, 
  3.938220171290008*^9}, {3.938220250009721*^9, 3.938220262325632*^9}, {
  3.9382210476115627`*^9, 3.938221048197288*^9}},
 CellLabel->"In[289]:=",
 CellID->375228031,ExpressionUUID->"33b1d6d8-f23a-4438-81a5-8397de4bf26a"],

Cell[BoxData[
 RowBox[{"solution", "=", 
  RowBox[{"NDSolveValue", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ScriptCapitalH]", "==", "0"}], ",", 
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"0", ",", "x", ",", "y"}], "]"}], "==", "initial"}], ",", 
      "bc"}], "}"}], ",", "\[CapitalPsi]", ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "\[CapitalOmega]"}], ",", 
    
    RowBox[{"Method", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<MethodOfLines\>\"", ",", 
       RowBox[{"\"\<SpatialDiscretization\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<FiniteElement\>\"", ",", 
          RowBox[{"\"\<MeshOptions\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<MaxCellMeasure\>\"", "->", "0.01"}], "}"}]}]}], 
         "}"}]}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.938217427078342*^9, 3.938217427174748*^9}, {
   3.938217494111254*^9, 3.938217517876745*^9}, {3.9382177823854*^9, 
   3.9382177828737*^9}, {3.93821799770336*^9, 3.9382180082106853`*^9}, {
   3.938218639836166*^9, 3.938218640961679*^9}, {3.938218710654821*^9, 
   3.938218710658272*^9}, {3.938219053576034*^9, 3.9382190783907833`*^9}, {
   3.9382191326090183`*^9, 3.938219141848577*^9}, {3.938219464742283*^9, 
   3.93821949342986*^9}, {3.9382198278062353`*^9, 3.938219828109131*^9}, 
   3.938221059163477*^9, {3.938221992551289*^9, 3.9382219927355013`*^9}, 
   3.938225585720952*^9, {3.938259143641284*^9, 3.938259144038143*^9}, 
   3.93826232180838*^9, {3.938262381527478*^9, 3.938262383911603*^9}, {
   3.938263076028458*^9, 3.938263077714751*^9}, 3.938265899599133*^9, 
   3.938266533310281*^9, {3.93826666816262*^9, 3.938266673937155*^9}, 
   3.938271581729358*^9, 3.938271964819412*^9, {3.9382733855569477`*^9, 
   3.938273389775675*^9}, {3.9382739936266537`*^9, 3.938274001427654*^9}, {
   3.938278555841518*^9, 3.9382785567927322`*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"bbd861e1-f0fe-42a6-b81f-5389cdedfba2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"evolution", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ContourPlot", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"solution", "[", 
         RowBox[{"#", ",", "x", ",", "y"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "\[CapitalOmega]"}], 
       ",", 
       RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"PlotPoints", "->", "25"}], ",", 
       RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "5", ",", ".1"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.938217654265708*^9, 3.938217691266939*^9}, {
   3.938217794175229*^9, 3.93821779457699*^9}, 3.938217890048809*^9, {
   3.938217924411882*^9, 3.938217970750826*^9}, {3.938218830496994*^9, 
   3.9382188786839046`*^9}, {3.938218909374086*^9, 3.938218913438405*^9}, {
   3.938218948176856*^9, 3.9382189484234447`*^9}, {3.938218988851901*^9, 
   3.938218991347929*^9}, {3.938219794173074*^9, 3.9382197967394323`*^9}, {
   3.938220093735093*^9, 3.938220095519228*^9}, {3.9382202291510563`*^9, 
   3.9382202294954567`*^9}, {3.9382210654634447`*^9, 3.93822109641776*^9}, {
   3.938221893833105*^9, 3.938221894288314*^9}, {3.9382219966495*^9, 
   3.938221996803363*^9}, {3.938222097523232*^9, 3.938222105080318*^9}, {
   3.938222941139483*^9, 3.93822294674901*^9}, 3.938223660565187*^9, 
   3.938223712023347*^9, {3.9382255898944597`*^9, 3.938225591146596*^9}, {
   3.9382258029716587`*^9, 3.938225803711985*^9}, {3.938258976618292*^9, 
   3.938258977504732*^9}, {3.938259098189831*^9, 3.938259153609989*^9}, {
   3.938259183638248*^9, 3.93825918394385*^9}, {3.938259221337597*^9, 
   3.93825922377987*^9}, {3.938259623064558*^9, 3.9382596236029367`*^9}, {
   3.938259668851616*^9, 3.938259698862975*^9}, {3.938266591910716*^9, 
   3.93826659404368*^9}, {3.938278395729086*^9, 3.938278396220841*^9}},
 CellLabel->"In[335]:=",
 CellID->589612207,ExpressionUUID->"88fdc933-b60a-409a-a61b-48a4b6af6530"],

Cell[BoxData[
 RowBox[{"ListAnimate", "[", 
  RowBox[{"evolution", ",", 
   RowBox[{"AnimationRunning", "->", "False"}], ",", 
   RowBox[{"SaveDefinitions", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9382199932371607`*^9, 3.938220005796611*^9}, 
   3.938220064116665*^9, {3.938223716609645*^9, 3.9382237192734833`*^9}, 
   3.938224444727543*^9},
 CellLabel->
  "In[336]:=",ExpressionUUID->"58c8a233-044b-4dd9-ac2a-aa187b83752a"]
},
WindowSize->{808, 863},
WindowMargins->{{100, Automatic}, {0, Automatic}},
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a14d2d92-dd84-42aa-8507-d96163b6f624"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 949, 24, 52, "Input",ExpressionUUID->"cd8ee6f3-8928-4503-8aab-84636ff8fb13",
 CellID->31662885],
Cell[1510, 46, 3197, 65, 92, "Input",ExpressionUUID->"5e5d45b9-9dc3-49ea-8eaf-8bb9892c3350"],
Cell[4710, 113, 781, 19, 52, "Input",ExpressionUUID->"395932fe-8368-4a05-9c30-3253299928e0",
 CellID->647548651],
Cell[5494, 134, 759, 16, 30, "Input",ExpressionUUID->"33b1d6d8-f23a-4438-81a5-8397de4bf26a",
 CellID->375228031],
Cell[6256, 152, 2099, 43, 73, "Input",ExpressionUUID->"bbd861e1-f0fe-42a6-b81f-5389cdedfba2"],
Cell[8358, 197, 2184, 41, 73, "Input",ExpressionUUID->"88fdc933-b60a-409a-a61b-48a4b6af6530",
 CellID->589612207],
Cell[10545, 240, 442, 9, 30, "Input",ExpressionUUID->"58c8a233-044b-4dd9-ac2a-aa187b83752a"]
}
]
*)

