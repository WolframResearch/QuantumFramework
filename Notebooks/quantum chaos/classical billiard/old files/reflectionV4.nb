(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     34774,        769]
NotebookOptionsPosition[     31929,        718]
NotebookOutlinePosition[     32352,        735]
CellTagsIndexPosition[     32309,        732]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
A  billiard ball as a point reflected elastically inside a region\
\>", "Title",
 CellChangeTimes->{{3.939344828818431*^9, 
  3.939344837859236*^9}},ExpressionUUID->"5d1f9f70-239f-4c83-82af-\
26f976456046"],

Cell["\<\
Define a region
Discretizes the region into a MeshRegion. 
Then given its boundary edge indices, find all boundary edges
Given a point on one of the edges, define a direction and a ray (green line)
Find the first edge that the ray intersect
Given the intersection point, find the reflection by considering the edge at \
the intersection point
Repeat this process
\
\>", "Text",
 CellChangeTimes->{{3.939344576736163*^9, 
  3.9393447083237343`*^9}},ExpressionUUID->"216c8704-687b-4285-9df7-\
2dd145060881"],

Cell[CellGroupData[{

Cell["Ball confined in a region", "Section",
 CellChangeTimes->{{3.939230483211307*^9, 3.9392304841883373`*^9}, {
   3.9392478514933434`*^9, 3.9392478784339*^9}, {3.939255476131839*^9, 
   3.939255482714525*^9}, 3.939255528868469*^9, 3.939341588526066*^9, {
   3.939342217377469*^9, 3.939342217657139*^9}, {3.939342457848831*^9, 
   3.939342458874254*^9}, 3.939343821713194*^9, {3.9393439248506327`*^9, 
   3.93934393538647*^9}},ExpressionUUID->"5d3c20ce-e0b3-4050-9300-\
a55195cc5ac9"],

Cell["Define a region:", "Text",
 CellChangeTimes->{{3.939341886746718*^9, 3.939341891202108*^9}, {
  3.939342620697832*^9, 
  3.9393426234481077`*^9}},ExpressionUUID->"9a250add-7442-4984-8465-\
cdedb4adf94c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"reg", "=", " ", 
    RowBox[{"RegionUnion", "[", 
     RowBox[{
      GraphicsBox[
       TagBox[
        DynamicModuleBox[{Typeset`mesh = HoldComplete[
          MeshRegion[CompressedData["
1:eJx1knlMEnAUx/FoKVocXrAwFMXEIxAUD2C80pRarUxLk7K0W1vmEm1htYzW
sbLaajUym6LVslHzKI1jz/zDDjvM7HSZaZlmdo3FJLt++m9ve3v/fPfd3j6f
wNyCpeudKRRK9N/9d5v2p1UqNoRi9+CW7tCbgXBY+xJvbQ3DmY6YweXRQchS
iG78tPqAqkItVJtE+DhQsqf0hRiK1iUdTRDRLLLnNWvnvWRB0eanhkSuBFYL
tLX5qigsVGXNpvkLYFGNVWpcKMZr6iBQnA7Ds5i2QbzPHxTnypcGNEmRFZmU
7giMB92gi96vZYZlOHLdIcXiANiU597uxo6H/mMd2uZVUjzwxNA2phTBUyp9
miMnFnnZBzsY4yL0rDZRGw08kFS2at4Z5Zgdt0ywM08JbzzTtukv8S2U3tE7
K1PmgC1LraJ3zbKMlumKW08Gw9WZ6qm365TItsbtqBqJx+Trbbn3usUYkmh7
n/0hDo0RvSsaWWJ4OD3StgB48Ha4OvOjjxxM9R3WhGQ5aMj/XIuw9VvlhfoA
aPYPHXCuj8fjGYNV6c+i0eGh33JNNRurewx0ZpcErfZHWWUPIsBVL5WtMXNg
dKggJoQjBc1F05BpPAY+H2PuKoliWnp+tZb7VbHhFseGimYJMt6Gn6bphLi5
7orX3XchKBupKTqsjUTemX6ninw+bPX1OhJm94axD3JmDk8EE/8LoWHbXDSm
OVkytJW9fT0M0MfqZF9Lw9HF59CwZgUfL5/arWmfwkUR1/n2lyVBSCsYSc1n
cKCR39sytJEKno+8XsemBsMEbx4YPpU1dN4dMJ//bFuTGeUKq/Plw/eZXBwi
fHxxD+FDx/mENxPNhDcV+MQfmzKZ+EOHCd7uQPnPhBOfnis1xKfvyp3GWG9B
EgXZMSc4fdU/lM3EVzfsJL46YQjJ25XFJO816RN70qdXZj7xwxlExA8OpBfm
9KeUcLBk+m+7zugNpaQ/AL1Jvx/yt7Pp5TYPqJWmsiL28Sf7BJN9DnNt+t5G
mi8DKJ3JTuMLwuAPkcpsmw==
           "], {
            
            Polygon[{{52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 
             38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 
             22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 
             5, 4, 3, 2, 1}}]}, 
           Method -> {
            "EliminateUnusedCoordinates" -> True, 
             "DeleteDuplicateCoordinates" -> Automatic, "VertexAlias" -> 
             Identity, "CheckOrientation" -> True, "CoplanarityTolerance" -> 
             Automatic, "CheckIntersections" -> Automatic, "BoundaryNesting" -> 
             Automatic, "SeparateBoundaries" -> False, "PropagateMarkers" -> 
             True, "Hash" -> 1735330029991621292}]]}, 
         TagBox[GraphicsComplexBox[CompressedData["
1:eJx1knlMEnAUx/FoKVocXrAwFMXEIxAUD2C80pRarUxLk7K0W1vmEm1htYzW
sbLaajUym6LVslHzKI1jz/zDDjvM7HSZaZlmdo3FJLt++m9ve3v/fPfd3j6f
wNyCpeudKRRK9N/9d5v2p1UqNoRi9+CW7tCbgXBY+xJvbQ3DmY6YweXRQchS
iG78tPqAqkItVJtE+DhQsqf0hRiK1iUdTRDRLLLnNWvnvWRB0eanhkSuBFYL
tLX5qigsVGXNpvkLYFGNVWpcKMZr6iBQnA7Ds5i2QbzPHxTnypcGNEmRFZmU
7giMB92gi96vZYZlOHLdIcXiANiU597uxo6H/mMd2uZVUjzwxNA2phTBUyp9
miMnFnnZBzsY4yL0rDZRGw08kFS2at4Z5Zgdt0ywM08JbzzTtukv8S2U3tE7
K1PmgC1LraJ3zbKMlumKW08Gw9WZ6qm365TItsbtqBqJx+Trbbn3usUYkmh7
n/0hDo0RvSsaWWJ4OD3StgB48Ha4OvOjjxxM9R3WhGQ5aMj/XIuw9VvlhfoA
aPYPHXCuj8fjGYNV6c+i0eGh33JNNRurewx0ZpcErfZHWWUPIsBVL5WtMXNg
dKggJoQjBc1F05BpPAY+H2PuKoliWnp+tZb7VbHhFseGimYJMt6Gn6bphLi5
7orX3XchKBupKTqsjUTemX6ninw+bPX1OhJm94axD3JmDk8EE/8LoWHbXDSm
OVkytJW9fT0M0MfqZF9Lw9HF59CwZgUfL5/arWmfwkUR1/n2lyVBSCsYSc1n
cKCR39sytJEKno+8XsemBsMEbx4YPpU1dN4dMJ//bFuTGeUKq/Plw/eZXBwi
fHxxD+FDx/mENxPNhDcV+MQfmzKZ+EOHCd7uQPnPhBOfnis1xKfvyp3GWG9B
EgXZMSc4fdU/lM3EVzfsJL46YQjJ25XFJO816RN70qdXZj7xwxlExA8OpBfm
9KeUcLBk+m+7zugNpaQ/AL1Jvx/yt7Pp5TYPqJWmsiL28Sf7BJN9DnNt+t5G
mi8DKJ3JTuMLwuAPkcpsmw==
           "], 
           {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
            PolygonBox[{{52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 
             39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 
             23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 
             6, 5, 4, 3, 2, 1}}]}],
          MouseAppearanceTag["LinkHand"]],
         AllowKernelInitialization->False],
        "MeshGraphics",
        AutoDelete->True,
        Editable->False,
        Selectable->False],
       DefaultBaseStyle->{
        "Graphics", FrontEnd`GraphicsHighlightColor -> Hue[0.1, 1, 0.7]},
       ImageSize->{68., Automatic}], ",", 
      GraphicsBox[
       TagBox[
        DynamicModuleBox[{Typeset`mesh = HoldComplete[
          MeshRegion[CompressedData["
1:eJx1U2tIU2EYPtVEhCRbmQ4ZOi9tq2ZTs3Se414vpZYozBaCti5eKhMTVIzM
irAfBRKJUOmPqMH0R4RkFjlPvhZYdt/CICaVkknCsnJQIkL5vd/52YHD4YP3
fa7f0R0+YataKQhC5r93+bs/zW48VbMVqw8M91VEJ0iNDaY020gMPsupa7EF
mfDc7r6yI690oDUkOHvGE9GrSzl7+kMyNFbmtlvMa+SohYFbV6bjwHqyYMGQ
kQTat2mjrp/xWDsb314SlwxNPe5v7qVUzFqaXXs/PVx6fCYz1BOix+uvffd6
51Nw0D5i/hpugDF4kP/Otw0jTbl7F3Xp0DazqiviYZRco3raHJa4Cebj6+oN
t7fDPl9Bd4JlM+qvFqhKOnfA4N2Xjyy7RGz9ndM9fSFbUl8qniq2mbCoRdjS
W5mOvw56g6ocidDm9w17Cy1Ifq1AfnfKwqfvY+V5WSAPBE3EiHlyPvNvhknm
X8KJ4FpXXoYZez0dM3qtqOzj5B7ZMtqZKwUIHzk+hBE/cH5wkz5oYnlFy6Wk
HzaSfjxK/jBA/hT/2FnzxBXIipTclA/yfGCE8oMuyk/JF+Yuq1ubk9RyNOUP
xyl/1FA/yPtR+sPw1YXBH0uNUgf1ixuoX2ig/mGM+gcH3Q/or8/GOyUr5KmL
y/60UMb8GfEa8xOF65gfPddvRKf/fL/neUC8yfRGoJPpjYMcpm89HGL6YoH0
xALNfxlyMP4wGGf8WvzD+ELRzvg0HF+DdD9eiBkMT4UVDE8N1WxfAA/bDwWa
DwHhPw/Nf7bSvN9awc4/hr3svGTl+5zPLR4jfHxD+JhK/FBF/Io+fn99Q1w/
cP3A/eF78qf4R/qf5sQiygcdlA/eoPyA56fky/EXh7oof+D5wyT1g+XUD/wF
ndml1w==
           "], {
            
            Polygon[{{62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 
             48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 
             32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 
             16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1}}]}, 
           Method -> {
            "EliminateUnusedCoordinates" -> True, 
             "DeleteDuplicateCoordinates" -> Automatic, "VertexAlias" -> 
             Identity, "CheckOrientation" -> True, "CoplanarityTolerance" -> 
             Automatic, "CheckIntersections" -> Automatic, "BoundaryNesting" -> 
             Automatic, "SeparateBoundaries" -> False, "PropagateMarkers" -> 
             True, "Hash" -> 3506100760566536760}]]}, 
         TagBox[GraphicsComplexBox[CompressedData["
1:eJx1U2tIU2EYPtVEhCRbmQ4ZOi9tq2ZTs3Se414vpZYozBaCti5eKhMTVIzM
irAfBRKJUOmPqMH0R4RkFjlPvhZYdt/CICaVkknCsnJQIkL5vd/52YHD4YP3
fa7f0R0+YataKQhC5r93+bs/zW48VbMVqw8M91VEJ0iNDaY020gMPsupa7EF
mfDc7r6yI690oDUkOHvGE9GrSzl7+kMyNFbmtlvMa+SohYFbV6bjwHqyYMGQ
kQTat2mjrp/xWDsb314SlwxNPe5v7qVUzFqaXXs/PVx6fCYz1BOix+uvffd6
51Nw0D5i/hpugDF4kP/Otw0jTbl7F3Xp0DazqiviYZRco3raHJa4Cebj6+oN
t7fDPl9Bd4JlM+qvFqhKOnfA4N2Xjyy7RGz9ndM9fSFbUl8qniq2mbCoRdjS
W5mOvw56g6ocidDm9w17Cy1Ifq1AfnfKwqfvY+V5WSAPBE3EiHlyPvNvhknm
X8KJ4FpXXoYZez0dM3qtqOzj5B7ZMtqZKwUIHzk+hBE/cH5wkz5oYnlFy6Wk
HzaSfjxK/jBA/hT/2FnzxBXIipTclA/yfGCE8oMuyk/JF+Yuq1ubk9RyNOUP
xyl/1FA/yPtR+sPw1YXBH0uNUgf1ixuoX2ig/mGM+gcH3Q/or8/GOyUr5KmL
y/60UMb8GfEa8xOF65gfPddvRKf/fL/neUC8yfRGoJPpjYMcpm89HGL6YoH0
xALNfxlyMP4wGGf8WvzD+ELRzvg0HF+DdD9eiBkMT4UVDE8N1WxfAA/bDwWa
DwHhPw/Nf7bSvN9awc4/hr3svGTl+5zPLR4jfHxD+JhK/FBF/Io+fn99Q1w/
cP3A/eF78qf4R/qf5sQiygcdlA/eoPyA56fky/EXh7oof+D5wyT1g+XUD/wF
ndml1w==
           "], 
           {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
            PolygonBox[{{62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 
             49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 
             33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 
             17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1}}]}],
          MouseAppearanceTag["LinkHand"]],
         AllowKernelInitialization->False],
        "MeshGraphics",
        AutoDelete->True,
        Editable->False,
        Selectable->False],
       DefaultBaseStyle->{
        "Graphics", FrontEnd`GraphicsHighlightColor -> Hue[0.1, 1, 0.7]},
       ImageSize->{68., Automatic}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{"RegionDifference", "[", 
    RowBox[{
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", 
         RowBox[{"-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"StadiumShape", "[", "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.939339931594549*^9, 3.939339934079892*^9}, 
   3.9393418688670597`*^9, {3.939342462174061*^9, 3.939342528922373*^9}, {
   3.939343817734166*^9, 3.9393438190104923`*^9}, {3.939343942583846*^9, 
   3.939343965764278*^9}, {3.939343998155513*^9, 3.939344013612956*^9}, 
   3.939344045357901*^9, {3.939344290757375*^9, 3.939344291479348*^9}, {
   3.939344740887375*^9, 3.939344783990801*^9}, {3.939344845801482*^9, 
   3.939344847523621*^9}},ExpressionUUID->"0b2d2ef2-5076-4fd5-8ad3-\
feb874be0973"],

Cell["Find all of its boundary edges:", "Text",
 CellChangeTimes->{{3.9393418942061043`*^9, 
  3.939341901447132*^9}},ExpressionUUID->"fc3487bb-13a0-4102-8cb8-\
59ae03e100d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"edges", "=", 
   RowBox[{"boundaryEdges", "[", "reg", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.939339557445527*^9, 3.9393395988183002`*^9}, {
   3.939341491712356*^9, 3.9393414961263313`*^9}, 3.9393437867706623`*^9, {
   3.9393444147207613`*^9, 3.939344414931446*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"62e26c7b-bfd6-437a-8765-2421ef58d2ed"],

Cell["\<\
From boundary edges, pick one randomly and one point within that:\
\>", "Text",
 CellChangeTimes->{{3.9393415024270353`*^9, 
  3.9393415127329893`*^9}},ExpressionUUID->"edb5ed98-1b0f-43c3-ba06-\
4dcd4d450ea0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"edge1", "=", 
   RowBox[{"RandomChoice", "[", "edges", "]"}]}], ";", "\[IndentingNewLine]", 
  
  RowBox[{"p1", "=", 
   RowBox[{"Mean", "@@", "edge1"}]}], ";"}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"a83ed099-d306-48b2-b5ed-13b7416fef48"],

Cell[TextData[{
 "From the initial point, pick a ray in a given direction\n",
 StyleBox["Make sure the ray does not go outside of the region",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.9393419118344*^9, 3.939341933651246*^9}, {
  3.939344094487224*^9, 
  3.939344103643545*^9}},ExpressionUUID->"fa96ce90-8468-44b7-9bb4-\
699d6fd96c56"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Opacity", "[", ".3", "]"}], ",", 
        RowBox[{"DiscretizeRegion", "@", "reg"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
        RowBox[{"Point", "[", "p1", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Green", ",", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"ray1", "=", 
          RowBox[{"HalfLine", "[", 
           RowBox[{"p1", ",", 
            RowBox[{"pnt2", "-", "p1"}]}], "]"}]}], "]"}]}], "}"}]}], "}"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pnt2", ",", 
       RowBox[{"Mean", "@@", 
        RowBox[{"RandomChoice", "[", "edges", "]"}]}]}], "}"}], ",", 
     "Locator"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.939337587103855*^9, 3.939337618529093*^9}, {
   3.93933858548418*^9, 3.939338590615695*^9}, {3.939338630090927*^9, 
   3.93933863071482*^9}, {3.939338705070773*^9, 3.9393387086386538`*^9}, {
   3.939338786047577*^9, 3.939338811032859*^9}, {3.9393400147127733`*^9, 
   3.939340020560914*^9}, {3.939340108512102*^9, 3.939340142790566*^9}, {
   3.939340226556553*^9, 3.939340236756268*^9}, {3.9393403801437387`*^9, 
   3.9393403899436703`*^9}, {3.9393404459651833`*^9, 3.939340570410604*^9}, 
   3.93934071141639*^9, {3.939341323248397*^9, 3.939341410774125*^9}, 
   3.939342541934535*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"720bb267-4056-492e-977f-1dc8693d832a"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`pnt2$$ = {
    6.919218129322928, -20.661487014470097`}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pnt2$$], {6.919218129322928, -20.661487014470097`}}, 
      Automatic, ControlType -> Locator}}, Typeset`size$$ = {
    450., {232.34437733226767`, 239.50929432445517`}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`pnt2$$ = {
         6.919218129322928, -20.661487014470097`}}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> Graphics[{{
          Opacity[0.3], 
          DiscretizeRegion[$CellContext`reg]}, {Red, 
          PointSize[Medium], 
          Point[$CellContext`p1]}, {Green, 
          
          Dynamic[$CellContext`ray1 = 
           HalfLine[$CellContext`p1, $CellContext`pnt2$$ - \
$CellContext`p1]]}}], 
      "Specifications" :> {{{$CellContext`pnt2$$, {
          6.919218129322928, -20.661487014470097`}}, Automatic, ControlType -> 
         Locator}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{510.875, {270.55740910106647`, 277.72232609325397`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.939337591280863*^9, 3.9393376187322397`*^9}, 
   3.939338068769079*^9, 3.9393387091326933`*^9, {3.9393387896377707`*^9, 
   3.9393388115558662`*^9}, 3.939339142192556*^9, 3.939339625902088*^9, 
   3.939339942398714*^9, 3.939340022808502*^9, 3.939340145509163*^9, 
   3.939340242408689*^9, 3.939340574949523*^9, {3.939341239692378*^9, 
   3.9393412567331142`*^9}, {3.9393413571678333`*^9, 3.939341415363584*^9}, 
   3.939341935100161*^9, 3.939342480601923*^9, 3.939342533816*^9, 
   3.939343790007127*^9, 3.939343823927496*^9, 3.939344047715415*^9, 
   3.93934429633455*^9, 3.939344418047779*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"256553c8-521b-4d92-b8f2-bddc5a8af147"]
}, Open  ]],

Cell["\<\
Given initial edge, point, and ray, find all 200 reflections within the \
region:\
\>", "Text",
 CellChangeTimes->{{3.939341942078042*^9, 3.9393419758473186`*^9}, {
  3.939344066290773*^9, 
  3.9393440669782743`*^9}},ExpressionUUID->"5cf05181-f650-4870-9862-\
71bfe8faa1a1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"final", "=", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"reflect", "[", 
        RowBox[{"#", ",", "edges"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "edge1", ",", "ray1"}], "}"}], ",", "1000"}], 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.9392317375938587`*^9, 3.9392317549901533`*^9}, {
   3.939232011043541*^9, 3.939232014849805*^9}, 3.9392321632958727`*^9, {
   3.9392477830594587`*^9, 3.939247783249255*^9}, {3.939251665287242*^9, 
   3.9392516657683277`*^9}, 3.939255955556601*^9, {3.9392559880396757`*^9, 
   3.939255988175909*^9}, 3.9393026066795263`*^9, {3.939337745901227*^9, 
   3.9393377550317097`*^9}, {3.939337988041236*^9, 3.939337988612919*^9}, {
   3.939338057820743*^9, 3.939338060397703*^9}, {3.939339055376001*^9, 
   3.939339063804418*^9}, 3.939339620530511*^9, 3.939341430068748*^9, 
   3.939341977775166*^9, {3.9393425475465117`*^9, 3.939342550950884*^9}, {
   3.939344421918592*^9, 3.939344444902605*^9}, {3.939344478449423*^9, 
   3.939344479545644*^9}, {3.9393445542517977`*^9, 3.939344555403513*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"285231e1-b6c4-4212-a10f-8829a0b2e2d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"88.23802`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9392321107800713`*^9, 3.939233652960096*^9, 3.939247820270886*^9, {
   3.939251614193119*^9, 3.939251645025176*^9}, 3.939251948750959*^9, 
   3.939255956671726*^9, 3.939255990092168*^9, 3.939256105634416*^9, 
   3.9392562740371523`*^9, 3.939256304348805*^9, 3.939256365286994*^9, {
   3.939256410482975*^9, 3.9392564363719397`*^9}, 3.939256474253426*^9, 
   3.939301990459293*^9, 3.9393021228461113`*^9, 3.939302214512382*^9, 
   3.939302245782626*^9, 3.9393023788743134`*^9, {3.9393024274981318`*^9, 
   3.9393024687043333`*^9}, {3.939302632492111*^9, 3.9393026400643167`*^9}, 
   3.939302791514009*^9, 3.9393029231172543`*^9, {3.939302989395973*^9, 
   3.9393030026826572`*^9}, {3.939303069574664*^9, 3.939303118339901*^9}, 
   3.939303177128084*^9, {3.939303375012971*^9, 3.9393034007674713`*^9}, 
   3.9393377563765097`*^9, 3.939337993095766*^9, 3.939338110928124*^9, 
   3.9393387823371897`*^9, 3.939339064308217*^9, 3.939339102886568*^9, 
   3.939339148669519*^9, {3.939339626244385*^9, 3.939339636293893*^9}, {
   3.9393414260722427`*^9, 3.9393414328347054`*^9}, 3.939342005283196*^9, 
   3.9393424808756647`*^9, {3.939342548893408*^9, 3.939342559656962*^9}, {
   3.939343800192463*^9, 3.939343825483368*^9}, 3.939344057255842*^9, {
   3.939344412156611*^9, 3.939344423867118*^9}, 3.93934445412129*^9, 
   3.939344523990143*^9, 3.939344644341714*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"f5656b1f-8657-4131-a8c1-311cf6a9af15"]
}, Open  ]],

Cell["Find all rays reflected within the region:", "Text",
 CellChangeTimes->{{3.939341985512107*^9, 
  3.9393419959385757`*^9}},ExpressionUUID->"88d172ca-25e5-469d-8fac-\
2ea110712b41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lines", "=", 
   RowBox[{"Line", "/@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"final", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "2", ",", "1"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9392317693211613`*^9, 3.9392317750033503`*^9}, {
   3.9392318419717083`*^9, 3.9392318776102667`*^9}, 3.939232005963386*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"316a26ee-7f94-48d8-a772-853c54d46840"],

Cell["Visualize them:", "Text",
 CellChangeTimes->{{3.9393419983475723`*^9, 
  3.9393420013973417`*^9}},ExpressionUUID->"db35c85b-5cfd-49fc-8708-\
c607a92ac717"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"edges", ",", 
        RowBox[{"Opacity", "[", ".2", "]"}], ",", "LightBlue", ",", 
        RowBox[{"DiscretizeRegion", "@", "reg"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Opacity", "[", ".2", "]"}], ",", 
        RowBox[{"lines", "[", 
         RowBox[{"[", 
          RowBox[{";;", "s"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", 
        RowBox[{"lines", "[", 
         RowBox[{"[", "s", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"s", ",", "1", ",", 
     RowBox[{"Length", "[", "lines", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9392318937940683`*^9, 3.939231950379652*^9}, 
   3.939254667385683*^9, {3.9392559680696287`*^9, 3.939255968764401*^9}, {
   3.939256546329095*^9, 3.939256552739876*^9}, {3.939256668942931*^9, 
   3.93925669774821*^9}, {3.9392567392118053`*^9, 3.9392567425593977`*^9}, {
   3.939257446341793*^9, 3.939257446999082*^9}, {3.939337919917008*^9, 
   3.939337943488792*^9}, {3.9393381731647387`*^9, 3.939338229030778*^9}, {
   3.939338267758697*^9, 3.939338270108897*^9}, {3.939338931698946*^9, 
   3.93933894180976*^9}, {3.939339068859474*^9, 3.939339070030126*^9}, {
   3.9393421001184483`*^9, 3.939342120503996*^9}, {3.9393425557971478`*^9, 
   3.939342559815189*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"9a180fa8-8454-4e47-b559-bbd7eeed5449"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`s$$ = 366, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`s$$], 1, 1000, 1, ControlType -> Manipulator}}, 
    Typeset`size$$ = {450., {200.74948473431732`, 207.91440172650482`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`s$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> Graphics[{{$CellContext`edges, 
          Opacity[0.2], LightBlue, 
          DiscretizeRegion[$CellContext`reg]}, {Red, 
          Opacity[0.2], 
          Part[$CellContext`lines, 
           Span[1, $CellContext`s$$]]}, {Blue, 
          Part[$CellContext`lines, $CellContext`s$$]}}], 
      "Specifications" :> {{$CellContext`s$$, 1, 1000, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{503.375, {269.7375165031161, 276.9024334953036}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.939231940711515*^9, 3.9392319538589354`*^9}, 
   3.9392321500747347`*^9, 3.93923408698632*^9, 3.939247820388423*^9, {
   3.9392516216083593`*^9, 3.939251646207041*^9}, 3.939251948966216*^9, {
   3.939254655158558*^9, 3.939254669615178*^9}, {3.939255969231838*^9, 
   3.939255993764345*^9}, {3.939256107594453*^9, 3.9392561104686728`*^9}, {
   3.93925627734575*^9, 3.939256307046605*^9}, {3.9392565135788183`*^9, 
   3.939256514846696*^9}, {3.939256553917935*^9, 3.939256556668908*^9}, {
   3.93925668698837*^9, 3.939256702207448*^9}, {3.939256743038753*^9, 
   3.939256745272047*^9}, {3.939257447277011*^9, 3.9392574495698843`*^9}, {
   3.939302026044498*^9, 3.9393020287208567`*^9}, {3.939302129741913*^9, 
   3.939302134304034*^9}, {3.93930224908985*^9, 3.9393022510837173`*^9}, {
   3.9393025023268337`*^9, 3.939302503932472*^9}, {3.939337928740993*^9, 
   3.939337931805419*^9}, {3.9393379974813147`*^9, 3.9393379985697412`*^9}, {
   3.9393381109931307`*^9, 3.9393381250583076`*^9}, {3.939338186705703*^9, 
   3.9393382306863403`*^9}, {3.939338270393317*^9, 3.9393382724128637`*^9}, 
   3.9393387824195766`*^9, {3.939338935291197*^9, 3.9393389426157923`*^9}, 
   3.939339070512394*^9, 3.939339105619486*^9, 3.939339151243486*^9, {
   3.9393396262573433`*^9, 3.939339639652026*^9}, {3.939341436038744*^9, 
   3.939341450185359*^9}, {3.939342021613597*^9, 3.939342023527083*^9}, {
   3.9393421016329107`*^9, 3.939342122876189*^9}, 3.939342480895917*^9, {
   3.939342559693551*^9, 3.939342565388584*^9}, {3.939343825510098*^9, 
   3.939343831146603*^9}, {3.939344057326473*^9, 3.9393440716659927`*^9}, {
   3.9393444271394863`*^9, 3.939344429728444*^9}, {3.939344459971567*^9, 
   3.939344464887135*^9}, {3.93934452870723*^9, 3.9393445305985107`*^9}, {
   3.939344719424242*^9, 3.9393447208110657`*^9}},
 CellLabel->"Out[39]=",ExpressionUUID->"d7c55295-0a9f-4aab-9dd3-f15a767e8c1e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initializations", "Section",
 CellChangeTimes->{{3.9393418386258*^9, 
  3.93934184185045*^9}},ExpressionUUID->"2acafe16-2c69-4e86-b139-\
862b3d28dab0"],

Cell["\<\
Given a region, first discretizes a region reg into a MeshRegion. Then given \
its boundary edge indices, find all boundary edges, which will be a \
collection of lines\
\>", "Text",
 CellChangeTimes->{{3.9393416265996428`*^9, 3.939341658574459*^9}, {
  3.939341702531177*^9, 
  3.939341746315527*^9}},ExpressionUUID->"18d2dffc-bb6d-4094-9a1f-\
430afcdb7e58"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "boundaryEdges", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundaryEdges", "[", 
   RowBox[{"reg_", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dg", ",", "boundaryedgeindices"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dg", "=", 
      RowBox[{"DiscretizeRegion", "[", 
       RowBox[{"reg", ",", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "DiscretizeRegion", "]"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"boundaryedgeindices", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"Length", "/@", 
          RowBox[{
           RowBox[{"dg", "[", 
            RowBox[{"\"\<ConnectivityMatrix\>\"", "[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", 
           "\"\<AdjacencyLists\>\"", "]"}]}], ",", "1"}], "]"}]}]}], ";", 
     RowBox[{"MeshPrimitives", "[", 
      RowBox[{"dg", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "boundaryedgeindices"}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.939209540328129*^9, 3.939209547890443*^9}, {
   3.939230194464059*^9, 3.93923021535541*^9}, 3.939247292251195*^9, {
   3.939249098985976*^9, 3.9392491002563066`*^9}, {3.939255757835003*^9, 
   3.939255771000781*^9}, {3.939331225166367*^9, 3.939331226052703*^9}, {
   3.939335876148491*^9, 3.9393358948983583`*^9}, {3.939335934989039*^9, 
   3.93933595037317*^9}, {3.939336311735877*^9, 3.939336313120298*^9}, {
   3.9393363849416323`*^9, 3.939336407832831*^9}, 3.939337069847644*^9, {
   3.939337519070429*^9, 3.939337519419409*^9}, {3.9393391195730133`*^9, 
   3.939339133881464*^9}, {3.939339186824601*^9, 3.939339199018778*^9}, {
   3.939339379172604*^9, 3.9393394769707003`*^9}, {3.939341620140106*^9, 
   3.939341623609791*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"156b8937-ded7-4314-bfc2-b632f931fcb1"],

Cell["\<\
Given an initial point, edge and ray, find the reflection inside a region \
with its given boundary edges. The result will be the next point on edges, \
its corresponding edge element and ray reflected from that point\
\>", "Text",
 CellChangeTimes->{{3.939341752735621*^9, 
  3.939341833207324*^9}},ExpressionUUID->"b5f548f1-d484-4706-a584-\
a575c28a33e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "reflect", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reflect", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1_", ",", "edge1_", ",", "ray1_"}], "}"}], ",", 
    "boundaryedges_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "boundaryLines", ",", "edge2", ",", "p2", ",", "reflectedP1", ",", 
      "ray2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"boundaryLines", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"boundaryedges", ",", 
        RowBox[{"{", "edge1", "}"}]}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"edge2", ",", 
        RowBox[{"{", "p2", "}"}]}], "}"}], "=", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"Graphics`Mesh`FindIntersections", "[", 
                RowBox[{"{", 
                 RowBox[{"#", ",", "ray1"}], "}"}], "]"}]}], "}"}], "&"}], "/@",
             "boundaryLines"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", 
             RowBox[{"{", "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", "p1"}], 
           "]"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"reflectedP1", "=", 
      RowBox[{
       RowBox[{"ReflectionTransform", "[", 
        RowBox[{
         RowBox[{"Subtract", "@@", 
          RowBox[{"edge2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", "p2"}], "]"}], "[", "p1", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ray2", "=", 
      RowBox[{"HalfLine", "[", 
       RowBox[{"p2", ",", 
        RowBox[{"Subtract", "@@", 
         RowBox[{"{", 
          RowBox[{"reflectedP1", ",", "p2"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "edge2", ",", "ray2"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Code",
 CellChangeTimes->{{3.939212240454524*^9, 3.939212278602808*^9}, {
   3.9392286152103157`*^9, 3.939228673960724*^9}, 3.939228889663363*^9, 
   3.939249173862238*^9, {3.939258192208714*^9, 3.939258197211576*^9}, {
   3.9393358033685093`*^9, 3.939335806944092*^9}, {3.939337086900206*^9, 
   3.939337132983433*^9}, {3.939337186837419*^9, 3.9393372501347303`*^9}, {
   3.939337533340128*^9, 3.939337578113407*^9}, {3.9393376247965393`*^9, 
   3.939337727860806*^9}, {3.9393389938856983`*^9, 3.939339003995595*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"a946a2c3-11d2-4a18-bb04-a17bc8ec02f7"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1728, 959},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"60aae904-dc97-4511-8f8e-a1be94777c0f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 216, 5, 120, "Title",ExpressionUUID->"5d1f9f70-239f-4c83-82af-26f976456046"],
Cell[795, 29, 515, 13, 233, "Text",ExpressionUUID->"216c8704-687b-4285-9df7-2dd145060881"],
Cell[CellGroupData[{
Cell[1335, 46, 486, 7, 82, "Section",ExpressionUUID->"5d3c20ce-e0b3-4050-9300-a55195cc5ac9"],
Cell[1824, 55, 209, 4, 42, "Text",ExpressionUUID->"9a250add-7442-4984-8465-cdedb4adf94c"],
Cell[2036, 61, 8496, 167, 159, "Input",ExpressionUUID->"0b2d2ef2-5076-4fd5-8ad3-feb874be0973"],
Cell[10535, 230, 175, 3, 42, "Text",ExpressionUUID->"fc3487bb-13a0-4102-8cb8-59ae03e100d2"],
Cell[10713, 235, 389, 7, 36, "Input",ExpressionUUID->"62e26c7b-bfd6-437a-8765-2421ef58d2ed"],
Cell[11105, 244, 219, 5, 42, "Text",ExpressionUUID->"edb5ed98-1b0f-43c3-ba06-4dcd4d450ea0"],
Cell[11327, 251, 286, 7, 62, "Input",ExpressionUUID->"a83ed099-d306-48b2-b5ed-13b7416fef48"],
Cell[11616, 260, 350, 8, 69, "Text",ExpressionUUID->"fa96ce90-8468-44b7-9bb4-699d6fd96c56"],
Cell[CellGroupData[{
Cell[11991, 272, 1614, 38, 62, "Input",ExpressionUUID->"720bb267-4056-492e-977f-1dc8693d832a"],
Cell[13608, 312, 2870, 55, 569, "Output",ExpressionUUID->"256553c8-521b-4d92-b8f2-bddc5a8af147"]
}, Open  ]],
Cell[16493, 370, 284, 7, 42, "Text",ExpressionUUID->"5cf05181-f650-4870-9862-71bfe8faa1a1"],
Cell[CellGroupData[{
Cell[16802, 381, 1247, 23, 36, "Input",ExpressionUUID->"285231e1-b6c4-4212-a10f-8829a0b2e2d8"],
Cell[18052, 406, 1545, 23, 41, "Output",ExpressionUUID->"f5656b1f-8657-4131-a8c1-311cf6a9af15"]
}, Open  ]],
Cell[19612, 432, 186, 3, 42, "Text",ExpressionUUID->"88d172ca-25e5-469d-8fac-2ea110712b41"],
Cell[19801, 437, 499, 12, 36, "Input",ExpressionUUID->"316a26ee-7f94-48d8-a772-853c54d46840"],
Cell[20303, 451, 161, 3, 42, "Text",ExpressionUUID->"db35c85b-5cfd-49fc-8708-c607a92ac717"],
Cell[CellGroupData[{
Cell[20489, 458, 1565, 34, 36, "Input",ExpressionUUID->"9a180fa8-8454-4e47-b559-bbd7eeed5449"],
Cell[22057, 494, 3823, 64, 567, "Output",ExpressionUUID->"d7c55295-0a9f-4aab-9dd3-f15a767e8c1e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25929, 564, 157, 3, 82, "Section",ExpressionUUID->"2acafe16-2c69-4e86-b139-862b3d28dab0"],
Cell[26089, 569, 369, 8, 42, "Text",ExpressionUUID->"18d2dffc-bb6d-4094-9a1f-430afcdb7e58"],
Cell[26461, 579, 2172, 50, 158, "Code",ExpressionUUID->"156b8937-ded7-4314-bfc2-b632f931fcb1"],
Cell[28636, 631, 367, 7, 69, "Text",ExpressionUUID->"b5f548f1-d484-4706-a584-a575c28a33e3"],
Cell[29006, 640, 2895, 74, 205, "Code",ExpressionUUID->"a946a2c3-11d2-4a18-bb04-a17bc8ec02f7"]
}, Open  ]]
}, Open  ]]
}
]
*)

